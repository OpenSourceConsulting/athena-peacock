{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "InstancesController",
        "id": "InstancesController"
    },
    "designerId": "5cd58917-0a0f-4f09-a3c7-ada96dc3897c",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#instancesGrid",
                "designer|targetType": "Ext.grid.Panel",
                "fn": "onInstancesGridSelect",
                "implHandler": [
                    "",
                    "//Instances Grid Item Click",
                    "",
                    "if(instancesConstants.selectRow == null || instancesConstants.selectRow.get(\"machineId\") != record.get(\"machineId\")) {",
                    "",
                    "    instancesConstants.selectRow = record;",
                    "",
                    "    this.selectInstanceGrid();",
                    "}",
                    "",
                    "/*",
                    "",
                    "var detailPanel = Ext.getCmp(\"instanceDetailPanel\");",
                    "detailPanel.layout.setActiveItem(1);",
                    "",
                    "Ext.getCmp(\"instanceTabPanel\").setActiveTab(0);",
                    "",
                    "//init clear",
                    "clearInterval(instancesConstants.chartInterval);",
                    "Ext.getStore(\"instanceMonitoringChartStore\").removeAll();",
                    "",
                    "//Description Data Loading",
                    "var descform = Ext.getCmp(\"instanceDescForm\");",
                    "",
                    "descform.getForm().reset();",
                    "",
                    "descform.getForm().waitMsgTarget = descform.getEl();",
                    "",
                    "descform.getForm().load({",
                    "    params : {",
                    "        instanceID : record.get(\"instanceID\")",
                    "    }",
                    "    ,url : GLOBAL.urlPrefix + \"/instance/getInstanceDescription\"",
                    "    ,waitMsg:'Loading...'",
                    "});",
                    "",
                    "",
                    "//Software Data Loading",
                    "var softwareGrid = Ext.getCmp('instanceSoftwareGrid');",
                    "",
                    "softwareGrid.getStore().load({",
                    "    params:{",
                    "        instanceID : record.get(\"instanceID\")",
                    "    }",
                    "});",
                    "",
                    "",
                    "//OS Package Data Loading",
                    "this.searchInstanceOs();",
                    "",
                    "",
                    "//Monitoring Data Loading",
                    "",
                    "instancesConstants.chartInterval = setInterval(function() {",
                    "",
                    "    var chartStore = Ext.getStore(\"instanceMonitoringChartStore\");",
                    "    chartStore.load({",
                    "        addRecords : true",
                    "    });",
                    "",
                    "    if(chartStore.getCount() > 30) {",
                    "        chartStore.remove(chartStore.getAt(0));",
                    "    }",
                    "",
                    "}, 5000);",
                    "",
                    "*/"
                ],
                "name": "cellclick",
                "scope": "me"
            },
            "designerId": "7cc8272e-956b-44cd-811f-60f601258eaf"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#instancesGrid",
                "designer|targetType": "Ext.grid.Panel",
                "fn": "onInstancesGridBeforeItemContextMenu",
                "implHandler": [
                    "//Instaces Grid Right Click Menu 호출",
                    "",
                    "var position = e.getXY();",
                    "e.stopEvent();",
                    "",
                    "instancesConstants.actionRow = record;",
                    "",
                    "instancesConstants.contextMenu.showAt(position);",
                    "",
                    ""
                ],
                "name": "beforeitemcontextmenu",
                "scope": "me"
            },
            "designerId": "27b3cbb8-bae5-4563-9928-26f2f79e396d"
        },
        {
            "type": "fixedfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "application"
                ],
                "fn": "init",
                "implHandler": [
                    "//Instances Menu Config Setting",
                    "",
                    "var instances = this;",
                    "",
                    "var instancesGridContextMenu = new Ext.menu.Menu({",
                    "    items:",
                    "    [",
                    "        { text: 'Edit Instance Name',",
                    "         handler: function() {",
                    "             instances.showEditInstanceNameWindow();",
                    "         }",
                    "        },",
                    "        { text: 'CLI(Command Line Interface)',",
                    "         handler: function() {",
                    "             instances.showCLIWindow();",
                    "         }",
                    "        },",
                    "        { text: 'Manage Account',",
                    "         handler: function() {",
                    "             instances.showManageAccountWindow();",
                    "         }",
                    "        },",
                    "        { text: 'Edit Fstab',",
                    "         handler: function() {",
                    "             instances.showFstabWindow();",
                    "         }",
                    "        },",
                    "        { text: 'Edit Crontab',",
                    "         handler: function() {",
                    "             instances.showCrontabWindow();",
                    "         }",
                    "        }",
                    "    ]",
                    "",
                    "});",
                    "",
                    "//Instances Menu Constants",
                    "Ext.define('instancesConstants', {",
                    "    singleton: true,",
                    "    me : instances,",
                    "    chartInterval : null,",
                    "    contextMenu: instancesGridContextMenu,",
                    "    selectRow : null,",
                    "    actionRow : null",
                    "});",
                    ""
                ]
            },
            "designerId": "ea573774-ed5d-4172-b001-7416fd3dfee2"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "init"
                ],
                "fn": "searchInstance",
                "implHandler": [
                    "",
                    "if(init) {",
                    "    Ext.getCmp(\"searchCategory\").setValue(\"\");",
                    "    Ext.getCmp(\"searchRhevm\").setValue(\"\");",
                    "    Ext.getCmp(\"searchInstanceName\").setValue(\"\");",
                    "",
                    "    Ext.getCmp(\"instancesGrid\").reconfigure(Ext.getCmp(\"instancesGrid\").store, Ext.getCmp(\"instancesGrid\").initialConfig.columns);",
                    "}",
                    "",
                    "instancesConstants.selectRow = null;",
                    "",
                    "//Instances Grid Data Search",
                    "",
                    "var instanceStore = Ext.getCmp(\"instancesGrid\").getStore();",
                    "",
                    "instanceStore.getProxy().extraParams = {",
                    "    isPrd : Ext.getCmp(\"searchCategory\").getRawValue(),",
                    "    hypervisorId : Ext.getCmp(\"searchRhevm\").getRawValue(),",
                    "    displayName : Ext.getCmp(\"searchInstanceName\").getRawValue()",
                    "};",
                    "",
                    "instanceStore.load();",
                    "",
                    "var detailPanel = Ext.getCmp(\"instanceDetailPanel\");",
                    "detailPanel.layout.setActiveItem(0);"
                ]
            },
            "designerId": "be575cdc-0f2c-4d5a-9046-e8371787c032"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "selectInstanceGrid",
                "implHandler": [
                    "",
                    "var detailPanel = Ext.getCmp(\"instanceDetailPanel\");",
                    "detailPanel.layout.setActiveItem(1);",
                    "",
                    "Ext.getCmp(\"instanceTabPanel\").setActiveTab(0);",
                    "",
                    "this.searchInstanceDetail(0);"
                ]
            },
            "designerId": "0372f274-cbef-437a-a6af-952e7cbe8bd3"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "tabIndex"
                ],
                "fn": "searchInstanceDetail",
                "implHandler": [
                    "/*",
                    "//init clear",
                    "clearInterval(instancesConstants.chartInterval);",
                    "Ext.getStore(\"instanceMonitoringChartStore\").removeAll();",
                    "",
                    "*/",
                    "",
                    "if(tabIndex == 0) {",
                    "",
                    "    //Description Data Loading",
                    "    var descform = Ext.getCmp(\"instanceDescForm\");",
                    "",
                    "    descform.getForm().reset();",
                    "",
                    "    descform.getForm().waitMsgTarget = descform.getEl();",
                    "",
                    "    descform.getForm().load({",
                    "        params : {",
                    "            machineId : instancesConstants.selectRow.get(\"machineId\")",
                    "        }",
                    "        ,url : GLOBAL.urlPrefix + \"machine/getMachine\"",
                    "        ,waitMsg:'Loading...'",
                    "    });",
                    "",
                    "",
                    "} else if(tabIndex == 1) {",
                    "",
                    "    //Software Data Loading",
                    "    var softwareGrid = Ext.getCmp('instanceSoftwareGrid');",
                    "",
                    "    softwareGrid.getStore().load({",
                    "        params:{",
                    "            instanceID : record.get(\"instanceID\")",
                    "        }",
                    "    });",
                    "",
                    "} else if(tabIndex == 2) {",
                    "",
                    "    //OS Package Data Loading",
                    "    this.searchInstanceOs();",
                    "",
                    "} else {",
                    "",
                    "    //Monitoring Data Loading",
                    "",
                    "    instancesConstants.chartInterval = setInterval(function() {",
                    "",
                    "    var chartStore = Ext.getStore(\"instanceMonitoringChartStore\");",
                    "        chartStore.load({",
                    "            addRecords : true",
                    "        });",
                    "",
                    "        if(chartStore.getCount() > 30) {",
                    "            chartStore.remove(chartStore.getAt(0));",
                    "        }",
                    "",
                    "    }, 5000);",
                    "}",
                    "",
                    ""
                ]
            },
            "designerId": "8272ec8b-798d-449e-baa5-0d53e818543e"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "searchInstanceOs",
                "implHandler": [
                    "//Instances Os Package Grid Data Search",
                    "var packageStore = Ext.getCmp('instanceOsGrid').getStore();",
                    "",
                    "packageStore.getProxy().extraParams = {",
                    "    machineId : instancesConstants.selectRow.get(\"machineId\"),",
                    "    name : Ext.getCmp(\"searchPackageName\").getRawValue()",
                    "};",
                    "",
                    "packageStore.load();",
                    ""
                ]
            },
            "designerId": "95ae4b48-6781-48b0-889b-b0b3dd10284c"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showCLIWindow",
                "implHandler": [
                    "var CLIWindow = Ext.create(\"widget.CLIWindow\");",
                    "",
                    "CLIWindow.show();"
                ]
            },
            "designerId": "b4fd2fc9-3ff7-405c-b736-7d4c1e61667f"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showManageAccountWindow",
                "implHandler": [
                    "var manageAccountWindow = Ext.create(\"widget.manageAccountWindow\");",
                    "",
                    "manageAccountWindow.show();"
                ]
            },
            "designerId": "daee12f1-ab4e-404a-ad90-f7c93442ca26"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showFstabWindow",
                "implHandler": [
                    "var fstabWindow = Ext.create(\"widget.fstabWindow\");",
                    "",
                    "fstabWindow.show();"
                ]
            },
            "designerId": "9a19ef90-d375-4e2a-881b-ac4439926add"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showCrontabWindow",
                "implHandler": [
                    "var crontabWindow = Ext.create(\"widget.crontabWindow\");",
                    "",
                    "crontabWindow.show();"
                ]
            },
            "designerId": "2ccd2a67-191e-4df8-9930-cf9db429afe2"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#categoryCycle menuitem",
                "designer|targetType": "Ext.menu.CheckItem",
                "fn": "onCategoryCycleClick",
                "implHandler": [
                    "// Category Menu Click",
                    "if(Ext.getCmp(\"searchCategory\").getRawValue() != item.getId()) {",
                    "",
                    "    Ext.getCmp(\"searchCategory\").setRawValue(item.getId());",
                    "",
                    "    this.searchInstance();",
                    "}",
                    ""
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "5801d9c7-a705-404c-be19-3c8480fa1cef"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#rhevmCycle menuitem",
                "designer|targetType": "Ext.menu.CheckItem",
                "fn": "onRhevmCycleClick",
                "implHandler": [
                    "//RHEVM Menu Click",
                    "if(Ext.getCmp(\"searchRhevm\").getRawValue() != item.getId()) {",
                    "",
                    "    Ext.getCmp(\"searchRhevm\").setRawValue(item.getId());",
                    "",
                    "    this.searchInstance();",
                    "}",
                    ""
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "54ff767f-c05d-4e42-99c7-7f3c41ce6beb"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#searchInstanceName",
                "designer|targetType": "Ext.form.field.Text",
                "fn": "onSearchInstanceNameKeydown",
                "implHandler": [
                    "//Instance Name Search",
                    "if(e.getKey() == e.ENTER){",
                    "    this.searchInstance();",
                    "}"
                ],
                "name": "keydown",
                "scope": "me"
            },
            "designerId": "a68b97d7-00d3-47e8-b111-d5db205fb7ac"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#searchPackageName",
                "designer|targetType": "Ext.form.field.Text",
                "fn": "onSearchPackageNameKeydown",
                "implHandler": [
                    "//Instance Package Name Search",
                    "if(e.getKey() == e.ENTER){",
                    "    this.searchInstanceOs();",
                    "}"
                ],
                "name": "keydown",
                "scope": "me"
            },
            "designerId": "e1235ba0-220b-4a6b-90f5-111f8f653343"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#instanceTabPanel",
                "designer|targetType": "Ext.tab.Panel",
                "fn": "onInstanceTabPanelTabChange",
                "implHandler": [
                    "if(newCard.title == \"Description\"){",
                    "    ",
                    "    this.searchInstanceDetail(0);",
                    "    ",
                    "} else if(newCard.title == \"Software\"){",
                    "    ",
                    "} else if(newCard.title == \"OS Package\"){",
                    "    ",
                    "    Ext.getCmp(\"searchPackageName\").setValue(\"\");",
                    "    Ext.getCmp(\"instanceOsGrid\").reconfigure(Ext.getCmp(\"instanceOsGrid\").store, Ext.getCmp(\"instanceOsGrid\").initialConfig.columns);",
                    "    ",
                    "    this.searchInstanceDetail(2);",
                    "    ",
                    "} else {",
                    "    ",
                    "}",
                    "",
                    "/*",
                    "",
                    "if(newCard.title == \"Description\"){",
                    "",
                    "    Ext.getCmp(\"searchRhevmTemplateName\").setValue(\"\");",
                    "    Ext.getCmp(\"rhevmTemplateGrid\").reconfigure(Ext.getCmp(\"rhevmTemplateGrid\").store, Ext.getCmp(\"rhevmTemplateGrid\").initialConfig.columns);",
                    "",
                    "    this.searchRhevmChildGrid(\"rhevmTemplateGrid\");",
                    "",
                    "} else {",
                    "",
                    "    Ext.getCmp(\"searchRhevmVMName\").setValue(\"\");",
                    "    Ext.getCmp(\"rhevmVMGrid\").reconfigure(Ext.getCmp(\"rhevmVMGrid\").store, Ext.getCmp(\"rhevmVMGrid\").initialConfig.columns);",
                    "",
                    "    this.searchRhevmChildGrid(\"rhevmVMGrid\");",
                    "",
                    "}",
                    "*/"
                ],
                "name": "tabchange",
                "scope": "me"
            },
            "designerId": "888cc8ad-8dd2-47e5-85c7-9da718030c7e"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showEditInstanceNameWindow",
                "implHandler": [
                    "var editWindow = Ext.create(\"widget.EditInstanceNameWindow\");",
                    "editWindow.show();",
                    "",
                    "var instanceForm = Ext.getCmp(\"instanceNameForm\");",
                    "",
                    "instanceForm.getForm().findField(\"machineId\").setRawValue(instancesConstants.actionRow.get(\"machineId\"));",
                    "instanceForm.getForm().findField(\"displayName\").setRawValue(instancesConstants.actionRow.get(\"displayName\"));",
                    ""
                ]
            },
            "designerId": "48f17ebb-eef5-42e4-aa50-c5bad6d1292a"
        }
    ]
}